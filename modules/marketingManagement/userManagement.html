<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport"
		  content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
	<meta name="description" content="admin-themes-lab">
	<meta name="author" content="themes-lab">
	<link rel="shortcut icon" href="../assets/images/favicon.png"
		  type="image/png">
	<title>海道APP管理系统</title>
	<style>
		.weight>input {
			height: 25px;
			color:green;
			border-radius: 3px;
			width: 100%;
		}
		.abtn {
			min-width: 227px;
		}
		.form-control {
			border: 1px solid #ccc !important;
			background-color: #fff !important;
		}
	</style>
	<link href="../../assets/css/style.css" rel="stylesheet" />
	<link href="../../assets/css/theme.css" rel="stylesheet" />
	<link href="../../assets/css/ui.css" rel="stylesheet" />
	<link rel="stylesheet" href="../../assets/plugins/datatables/dataTables.min.css" />
	<link rel="stylesheet" href="../../assets/plugins/datatables/dataTables.bootstrap.min.css" />

	<script src="../../assets/plugins/modernizr/modernizr-2.6.2-respond-1.1.0.min.js"></script>
</head>
<body class="">
<section>
	<div class="main-content main-content-page">
		<!-- BEGIN PAGE CONTENT -->
		<div class="page-content" style="padding:0 30px">

			<div class="header">
				<h2>
					<strong>服务置顶</strong>
				</h2>
				<div class="breadcrumb-wrapper">
					<span id="expertHover" data-toggle="modal" data-target="#function_declaration_Modal" data-backdrop=""><i class="icon-question"></i></span>
				</div>
			</div>
			<div class="row">
				<div class="col-md-12">
					<div class="panel panel-default">
						<div class="panel-content pagination2">
							<div class="row">
								<div class="col-md-12 col-sm-12 col-xs-12">
									<div class="head">
										<div class="row">
											<div class="form-group col-md-12">

												<div class="col-sm-3  col-xs-6 control-select">
													<select class="form-control" id="psite">
														<option >服务分类</option>
														<option >家政</option>
														<option >货运</option>
														<option >钱找</option>
														<option >共享工具</option>
													</select>
												</div>
												<div class="col-sm-3 col-xs-6 control-select">
													<select class="form-control" id="site">
														<option >菜单分类</option>
														<option >月嫂</option>
														<option >保姆</option>
														<option >钟点工</option>
													</select>
												</div>

												<div class="col-sm-3 col-xs-6 control-select">
													<div class="append-icon">
														<input id="btnSearchName" class="form-control" placeholder="服务单号搜索" type="text">
														<i class="icon-magnifier"></i>
													</div>
												</div>
												<div class="col-sm-3 col-xs-6 control-select">
													<div class="append-icon">
														<input id="SearchName" class="form-control" placeholder="服务名称搜索" type="text">
														<i class="icon-magnifier"></i>
													</div>
												</div>
											</div>
										</div>
									</div>
									<table class="table table-striped dataTable"
										   id="leftTable" width="100%">

									</table>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<!-- END PAGE CONTENT -->
	</div>
	<!-- END MAIN CONTENT -->

</section>
<!-- BEGIN PRELOADER -->
<div class="loader-overlay">
	<div class="spinner">
		<div class="bounce1"></div>
		<div class="bounce2"></div>
		<div class="bounce3"></div>
	</div>
</div>
<!-- END PRELOADER -->



<a href="#" class="scrollup"><i class="fa fa-angle-up"></i> </a>
<script src="../../assets/plugins/jquery/jquery-1.11.1.min.js"></script>
<script src="../../assets/plugins/jquery/jquery-migrate-1.2.1.min.js"></script>
<script src="../../assets/plugins/jquery-ui/jquery-ui-1.11.2.min.js"></script>
<script src="../../assets/plugins/gsap/main-gsap.min.js"></script>
<script src="../../assets/plugins/bootstrap/js/bootstrap.min.js"></script>
<script src="../../assets/plugins/jquery-cookies/jquery.cookies.min.js"></script>
<!-- Jquery Cookies, for theme -->
<script src="../../assets/plugins/jquery-block-ui/jquery.blockUI.min.js"></script>
<!-- simulate synchronous behavior when using AJAX -->
<script src="../../assets/plugins/translate/jqueryTranslator.min.js"></script>
<!-- Translate Plugin with JSON data -->
<script src="../../assets/plugins/bootbox/bootbox.min.js"></script>
<!-- Modal with Validation -->
<script
		src="../../assets/plugins/mcustom-scrollbar/jquery.mCustomScrollbar.concat.min.js"></script>
<!-- Custom Scrollbar sidebar -->
<script
		src="../../assets/plugins/bootstrap-dropdown/bootstrap-hover-dropdown.min.js"></script>
<!-- Show Dropdown on Mouseover -->
<script src="../../assets/plugins/select2/select2.min.js"></script>
<!-- Select Inputs -->
<!-- Retina Display -->
<script src="../../assets/plugins/backstretch/backstretch.min.js"></script>
<!-- Background Image -->
<script
		src="../../assets/plugins/bootstrap-progressbar/bootstrap-progressbar.min.js"></script>
<!-- Animated Progress Bar -->
<script src="../../assets/js/plugins.js"></script>
<!-- Main Plugin Initialization Script -->
<script src="../../assets/js/page.js"></script>
<!-- Main Application Script -->

<!-- datatable -->
<script type="text/javascript"
		src="../../assets/plugins/datatables/jquery.dataTables.min.js"></script>
<script type="text/javascript"
		src="../../assets/plugins/datatables/dataTables.bootstrap.min.js"></script>

<script type="text/javascript" src="../../assets/js/jquery.form.js"></script>
<script type="text/javascript"
		src="../../assets/plugins/adaptive-modal/js/jquery.adaptive-modal.js"></script>
<script type="text/javascript"
		src="../../assets/plugins/icheck/icheck.min.js"></script>
<script src="../../assets/plugins/colorpicker/spectrum.min.js"></script>
<script type="text/javascript"
		src="../../assets/plugins/datatables/jquery.dataTables_userDef.js"></script>
<script type="text/javascript"
		src="../../assets/plugins/timepicker/jquery-ui-timepicker-addon.min.js"></script>
<!-- Time Picker -->
<script type="text/javascript"
		src="../../assets/plugins/jquery-moment/moment.js"></script>
<!-- moment -->
<script type="text/javascript"
		src="../../assets/plugins/datatables/dataTables.select.min.js"></script>



<script type="text/javascript" src="../../assets/plugins/layer/layer.js"></script>

<!-- 外联资源添加 -->
<script>
	$(function () {
		createLeftTable();
		$.ajax({
			url:"userManagement.json",
			success:function (msg) {
                console.log(msg);
            }
		});
		$("#psite").change(function () {
			console.log("gaibian")
        })
        function createLeftTable(){

            $('#leftTable').dataTable({

//				"ajax" : {
//				 "url" : "./userManagement.json",
//				 "data": function (data) {
////				 return $.extend( {}, data, {
////				 "siteid" : $("#psite").val(),
////				 "name" : $("#btnSearchName").val()
//					 console.log(data)
//				 	}
//				 },



                "data":[
                    {
                        "id": "01293012114",
                        "serviceNumber": 100101,
                        "moduleName": "家政服务",
                        "classify": "月嫂",
                        "serviceName": "提供月嫂服务",
                        "admin": "周志磊",
                        "weight": 101,
                        "operationTime": "2017-7-31 16:28:34",
                        "topState": "stick"
                    },
                    {
                        "id": "01293012118",
                        "serviceNumber": 100108,
                        "moduleName": "家政服务",
                        "classify": "月嫂",
                        "serviceName": "提供月嫂服务",
                        "admin": "王磊",
                        "weight": 101,
                        "operationTime": "2017-7-31 12:28:34",
                        "topState": "stick"
                    },
                    {
                        "id": "01293012115",
                        "serviceNumber": 100102,
                        "moduleName": "货运服务",
                        "classify": "司机",
                        "serviceName": "提供货运服务",
                        "admin": "吴京",
                        "weight": 99,
                        "operationTime": "",
                        "topState": "stick"
                    },
                    {
                        "id": "01293012115",
                        "serviceNumber": 100102,
                        "moduleName": "货运服务",
                        "classify": "司机",
                        "serviceName": "提供货运服务",
                        "admin": "吴京",
                        "weight": 99,
                        "operationTime": "",
                        "topState": "stick"
                    }, {
                        "id": "01293012115",
                        "serviceNumber": 100102,
                        "moduleName": "货运服务",
                        "classify": "司机",
                        "serviceName": "提供货运服务",
                        "admin": "吴京",
                        "weight": 99,
                        "operationTime": "",
                        "topState": "stick"
                    }, {
                        "id": "01293012115",
                        "serviceNumber": 100102,
                        "moduleName": "货运服务",
                        "classify": "司机",
                        "serviceName": "提供货运服务",
                        "admin": "吴京",
                        "weight": 99,
                        "operationTime": "",
                        "topState": "stick"
                    }, {
                        "id": "01293012115",
                        "serviceNumber": 100102,
                        "moduleName": "货运服务",
                        "classify": "司机",
                        "serviceName": "提供货运服务",
                        "admin": "吴京",
                        "weight": 99,
                        "operationTime": "",
                        "topState": "stick"
                    }, {
                        "id": "01293012115",
                        "serviceNumber": 100102,
                        "moduleName": "货运服务",
                        "classify": "司机",
                        "serviceName": "提供货运服务",
                        "admin": "吴京",
                        "weight": 99,
                        "operationTime": "",
                        "topState": "stick"
                    }, {
                        "id": "01293012115",
                        "serviceNumber": 100102,
                        "moduleName": "货运服务",
                        "classify": "司机",
                        "serviceName": "提供货运服务",
                        "admin": "吴京",
                        "weight": 99,
                        "operationTime": "",
                        "topState": "stick"
                    }, {
                        "id": "01293012115",
                        "serviceNumber": 100102,
                        "moduleName": "货运服务",
                        "classify": "司机",
                        "serviceName": "提供货运服务",
                        "admin": "吴京",
                        "weight": 99,
                        "operationTime": "",
                        "topState": "stick"
                    }
                    , {
                        "id": "01293012115",
                        "serviceNumber": 100102,
                        "moduleName": "货运服务",
                        "classify": "司机",
                        "serviceName": "提供货运服务",
                        "admin": "吴京",
                        "weight": 99,
                        "operationTime": "",
                        "topState": "stick"
                    }
                ],

                searching : false,
                lengthChange : false, // 是否启用设置每页显示记录数
                "language": {
                    "sLengthMenu": "&nbsp;&nbsp;&nbsp;&nbsp;每页显示 _MENU_ 条",
                    "sZeroRecords": "抱歉， 没有找到",
                    "sEmptyTable": "抱歉， 没有找到",
                    "sInfo": "显示 _START_ 到 _END_ 条　共 _TOTAL_ 条",
                    "sInfoEmpty": "没有记录",
                    "sInfoFiltered": "(从 _MAX_ 条数据中检索)",
                    "sProcessing":"正在加载中...",
                    "sSearch": "搜索：",
                    "oPaginate": {
                        "sFirst": "首页",
                        "sPrevious": "上一页",
                        "sNext": "下一页",
                        "sLast": "末页"
                    }
                },
                "pagingType": "full_numbers",//分页 有first last
                "columns" : [
					{
					    "data":"id",
						"visible":false,
						"render":function (data) {
					        var html = '<span id="'+ data +'"></span>';
							return html
                        }
					},
                    {
                        "title" : "分类名称",
                        "data" : "moduleName",
                        "visible" : true,
                        "orderable" : true,
                    },{
                        "title" : "菜单名称",
                        "data" : "classify",
                        "name" : "outreach.dutytel",
                        "visible" : true,
                        "orderable" : true
                    },
                    {
                        "title" : "服务单号",
                        "data" : "serviceNumber",
                        "name" : "outreach.linkman",
                        "visible" : true,
                        "orderable" : true
                    },

                    {
                        "title" : "服务名称",
                        "data" : "serviceName",
                        "name" : " outreach.linktel",
                        "visible" : true,
                        "orderable" : true
                    },
                    {
                        "title" : "发布人",
                        "data" : "admin",
                        "name" : "outreach.jobs",
                        "visible" : true,
                        "orderable" : true
                    },
                    {
                        "title" : "权重值",
                        "data" : "weight",
                        "name" : "outreach.jobs",
                        "visible" : true,
                        "orderable" : true,
                        "class":"weight"
                    },{
                        "title" : "服务状态",
                        "data" : "topState",
                        "name" : "site.sname",
                        "visible" : true,
                        "orderable" : true
                    },
                    {
                        "title" : "操作",
                        "data" : "weight",
                        "visible" : true,
                        "orderable" : false,
                        "class":"abtn",
                        "render" : function(data, type, full, meta) {
                            var unstick = "<a titile='取消置顶' class='unStick btn btn-sm btn-danger'>取消置顶</a><a title='详情' class='details btn btn-sm btn-info'></i>详情</a><a title='编辑' class='compile btn btn-sm btn-warning'></i>编辑</a>"
                            var operBtn = '<a title="置顶" class="stick btn btn-sm btn-blue">置顶</a>';
                            operBtn += '<a title="修改权重值" class="update btn btn-sm btn-warning">修改权重值</a><a title="保存" class=" save btn btn-sm btn-success" style="display:none">保存</a>';
							if(data == '101'){
							    return unstick;
							}else  {
                                return operBtn;
							}

                        }
                    } ],
//            "order" : [ [ 2, "desc" ] ]
//            "lengthMenu":[[5,10,25,50,-1],[5,10,25,50,"全部"]]

            });
		}
		//置顶
        $("tbody").on("click",".stick",function(){
				var that = $(this);
				var el = $(this).parent().parent()
				var html ='<a title="取消置顶" class="unStick btn btn-sm btn-danger" ></i>取消置顶</a><a title="详情" class="details btn btn-sm btn-info" ></i>详情</a><a title="编辑" class="compile btn btn-sm btn-warning"></i>编辑</a>';
            var num1 = layer.open({
                type: 1
                ,title: false //不显示标题栏
                ,closeBtn: false
                ,shade: 0.8
                ,id: 'LAY_layuipro' //设定一个id，防止重复弹出
                ,btn: ['确定', '取消']
                ,moveType: 1 //拖拽模式，0或者1
                ,content: '<div style="padding: 50px; line-height: 22px; background-color: skyblue; color: #fff; font-weight: 300;">你知道吗？亲！<br>layer ≠ layui<br><br>layer只是作为Layui的一个弹层模块，由于其用户基数较大，所以常常会有人以为layui是layerui<br><br>layer虽然已被 Layui 收编为内置的弹层模块，但仍然会作为一个独立组件全力维护、升级。<br><br>我们此后的征途是星辰大海 ^_^</div>'
                ,yes: function(){
                    that.parent().html(html).addClass("abtn");
                    el.find(".weight").html("101");
                    el.prependTo($("tbody"));
                    layer.close(num1);
                },
                area: ['500px', '300px']
            });

			});
        //修改权重
        $("tbody").on("click",".update",function(){
				var el = $(this).parent().parent()
				var text = el.find(".weight").text();
				var str = "<input class='form-control' type='text' value='"+text+"'>"
				el.find(".weight").html(str);
				$(this).css("display","none").siblings(".save").css("display","inline-block");


			});
        //保存
			$("tbody").on("click",".save",function(){
				var el = $(this).parent().parent()
				var val = el.find(".weight>input").val();
                console.log(val);
                el.find(".weight").html(val);
				$(this).css("display","none").siblings(".update").css("display","inline-block");
			});
    })
</script>
</body>
</html>